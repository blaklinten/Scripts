#!/bin/sh

IP="$(curl ifconfig.me)"
curl https://www.duckdns.org/update?domains=mircas\&token=TOKEN >> ~/.duckdns.log

while true; do
	sleep 5m;
	NEW_IP="$(curl ifconfig.me)";
	printf '%s\n%s%s\n%s%s\n' \
		"$(date)" "Old IP: " "$IP" "New IP: " "$NEW_IP"  >> ~/.duckdns.log
	if [ "$NEW_IP" != "$IP" ]; then
		curl https://www.duckdns.org/update?domains=mircas\&token=TOKEN >> ~/.duckdns.log
		printf '%s\n' "New IP! $NEW_IP" >> ~/.duckdns.log
		IP="$NEW_IP"
	fi
done
